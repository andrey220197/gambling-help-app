{
  "permissions": {
    "allow": [
      "Bash(./venv/Scripts/python.exe -m uvicorn:*)",
      "Bash(curl:*)",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxLCJleHAiOjE3NjU5MjM0ODUsImlhdCI6MTc2NTMxODY4NX0.EkDNYxU4AQNebfXKZ_v8jo1OT8_1-Nhgbx0i0La7x40\")",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxLCJleHAiOjE3NjU5MjM1MzMsImlhdCI6MTc2NTMxODczM30.D-GYSy-O7aTlmFjSRPY2L4Ne51UpQPrq8JW9NAA0PeI\")",
      "Bash(netstat:*)",
      "Bash(findstr:*)",
      "Bash(npm run dev:*)",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxLCJleHAiOjE3NjU5MjM4NDMsImlhdCI6MTc2NTMxOTA0M30.RhMhcDI9Iiz0sb8sa5TmUBJ-zPczOF8Cg7RzmnHUIhU\")",
      "Bash(./venv/Scripts/python.exe:*)",
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(cat:*)",
      "Bash(gh repo create:*)",
      "Bash(winget install:*)",
      "Bash(\"/c/Program Files/GitHub CLI/gh.exe\" auth status)",
      "Bash(\"/c/Program Files/GitHub CLI/gh.exe\" auth login --web --git-protocol https)",
      "Bash(\"/c/Program Files/GitHub CLI/gh.exe\" repo create gambling-help-app --public --source=. --push)",
      "Bash(git remote add:*)",
      "Bash(git push:*)",
      "WebFetch(domain:gambling-help-andrey220197.amvera.io)",
      "Bash(npm run build:*)",
      "Bash(python3 -c \"\nimport os\nos.chdir(''C:/Users/andrey220197/Desktop/clade_lud/gambling-help-app'')\n\ncontent = ''''''/**\n * –ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.\n */\n\nimport React, { useEffect, useState } from ''react''\nimport { HashRouter, Routes, Route, Navigate } from ''react-router-dom''\nimport { useStore } from ''./store/useStore''\nimport { useTelegram } from ''./hooks/useTelegram''\nimport { Layout } from ''./components/Layout''\n\n// Screens\nimport { Onboarding } from ''./screens/Onboarding''\nimport { Home } from ''./screens/Home''\nimport { CheckIn } from ''./screens/CheckIn''\nimport { Profile } from ''./screens/Profile''\nimport { SOS } from ''./screens/SOS''\nimport { Articles } from ''./screens/Articles''\nimport { ThoughtDiary } from ''./screens/ThoughtDiary''\nimport { ThoughtEntry } from ''./screens/ThoughtEntry''\n\n// Protected Route\nfunction ProtectedRoute({ children }) {\n  const { isOnboarding, isAuthenticated } = useStore()\n\n  if (!isAuthenticated) {\n    return <Navigate to=\"\"/onboarding\"\" replace />\n  }\n\n  if (isOnboarding) {\n    return <Navigate to=\"\"/onboarding\"\" replace />\n  }\n\n  return <>{children}</>\n}\n\n// Loading Screen with debug info\nfunction LoadingScreen({ debug }) {\n  return (\n    <div className=\"\"min-h-screen flex flex-col items-center justify-center bg-white p-4\"\">\n      <div className=\"\"w-16 h-16 bg-brand-100 rounded-full flex items-center justify-center mb-4 animate-pulse\"\">\n        <span className=\"\"text-3xl\"\">üéØ</span>\n      </div>\n      <h1 className=\"\"text-xl font-bold text-slate-800 mb-2\"\">–¢–æ—á–∫–∞ –æ–ø–æ—Ä—ã</h1>\n      <p className=\"\"text-slate-500 text-sm mb-4\"\">–ó–∞–≥—Ä—É–∑–∫–∞...</p>\n      {debug && (\n        <div className=\"\"text-xs text-slate-400 bg-slate-50 p-3 rounded-lg max-w-xs break-all\"\">\n          {debug}\n        </div>\n      )}\n    </div>\n  )\n}\n\n// Not in Telegram Screen\nfunction NotInTelegramScreen() {\n  return (\n    <div className=\"\"min-h-screen flex flex-col items-center justify-center bg-white p-6 text-center\"\">\n      <div className=\"\"w-20 h-20 bg-brand-100 rounded-full flex items-center justify-center mb-6\"\">\n        <span className=\"\"text-4xl\"\">üì±</span>\n      </div>\n      <h1 className=\"\"text-2xl font-bold text-slate-800 mb-3\"\">–¢–æ—á–∫–∞ –æ–ø–æ—Ä—ã</h1>\n      <p className=\"\"text-slate-500 mb-6 max-w-sm\"\">\n        –≠—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ Telegram.\n        –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞ @mindbalance_ru_bot –∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É \"\"–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ\"\".\n      </p>\n      <a\n        href=\"\"https://t.me/mindbalance_ru_bot\"\"\n        className=\"\"bg-brand-600 text-white px-6 py-3 rounded-xl font-medium hover:bg-brand-700 transition-colors\"\"\n      >\n        –û—Ç–∫—Ä—ã—Ç—å –≤ Telegram\n      </a>\n    </div>\n  )\n}\n\nfunction App() {\n  const {\n    isOnboarding, isAuthenticated, isLoading,\n    login, loadUserData, token\n  } = useStore()\n  const [appReady, setAppReady] = useState(false)\n  const [notInTelegram, setNotInTelegram] = useState(false)\n  const [debugInfo, setDebugInfo] = useState('''')\n\n  // Initialize Telegram WebApp\n  useTelegram()\n\n  // Auth flow\n  useEffect(() => {\n    const initAuth = async () => {\n      const tg = window.Telegram?.WebApp\n      const isLocalhost = window.location.hostname === ''localhost'' || window.location.hostname === ''127.0.0.1''\n\n      // Debug info\n      const hasInitData = tg?.initData ? ''yes('' + tg.initData.length + '')'' : ''no''\n      setDebugInfo(''TG:'' + (tg ? ''yes'' : ''no'') + '' data:'' + hasInitData)\n\n      // –ï—Å–ª–∏ —É–∂–µ –µ—Å—Ç—å —Ç–æ–∫–µ–Ω –≤ store\n      if (token && isAuthenticated) {\n        try {\n          await loadUserData()\n        } catch (error) {\n          console.error(''Failed to load user data:'', error)\n        }\n        setAppReady(true)\n        return\n      }\n\n      // –ü–æ–ª—É—á–∞–µ–º initData –æ—Ç Telegram\n      let initData = tg?.initData || ''''\n\n      // Debug mode\n      if (!initData && isLocalhost) {\n        initData = ''debug''\n      }\n\n      // –ï—Å–ª–∏ –Ω–µ—Ç initData –∏ –Ω–µ localhost\n      if (!initData && !isLocalhost) {\n        await new Promise(r => setTimeout(r, 500))\n        const tgRetry = window.Telegram?.WebApp\n        initData = tgRetry?.initData || ''''\n\n        const hasInitDataRetry = tgRetry?.initData ? ''yes('' + tgRetry.initData.length + '')'' : ''no''\n        setDebugInfo(prev => prev + '' retry:'' + hasInitDataRetry)\n\n        if (!initData) {\n          setNotInTelegram(true)\n          setAppReady(true)\n          return\n        }\n      }\n\n      if (initData) {\n        try {\n          setDebugInfo(prev => prev + '' auth...'')\n          await login(initData)\n          setDebugInfo(prev => prev + '' OK'')\n        } catch (error) {\n          console.error(''Auth failed:'', error)\n          setDebugInfo(prev => prev + '' ERR:'' + error.message)\n        }\n      }\n\n      setAppReady(true)\n    }\n\n    const timer = setTimeout(initAuth, 100)\n    return () => clearTimeout(timer)\n  }, [])\n\n  if (notInTelegram && !isAuthenticated) {\n    return <NotInTelegramScreen />\n  }\n\n  if (!appReady || isLoading) {\n    return <LoadingScreen debug={debugInfo} />\n  }\n\n  return (\n    <HashRouter>\n      <Layout>\n        <Routes>\n          <Route\n            path=\"\"/onboarding\"\"\n            element={\n              !isOnboarding && isAuthenticated\n                ? <Navigate to=\"\"/\"\" replace />\n                : <Onboarding />\n            }\n          />\n          <Route path=\"\"/\"\" element={<ProtectedRoute><Home /></ProtectedRoute>} />\n          <Route path=\"\"/checkin\"\" element={<ProtectedRoute><CheckIn /></ProtectedRoute>} />\n          <Route path=\"\"/profile\"\" element={<ProtectedRoute><Profile /></ProtectedRoute>} />\n          <Route path=\"\"/sos\"\" element={<ProtectedRoute><SOS /></ProtectedRoute>} />\n          <Route path=\"\"/articles\"\" element={<ProtectedRoute><Articles /></ProtectedRoute>} />\n          <Route path=\"\"/diary\"\" element={<ProtectedRoute><ThoughtDiary /></ProtectedRoute>} />\n          <Route path=\"\"/diary/new\"\" element={<ProtectedRoute><ThoughtEntry /></ProtectedRoute>} />\n          <Route path=\"\"*\"\" element={<Navigate to=\"\"/\"\" replace />} />\n        </Routes>\n      </Layout>\n    </HashRouter>\n  )\n}\n\nexport default App\n''''''\n\nwith open(''frontend/src/App.jsx'', ''w'', encoding=''utf-8'') as f:\n    f.write(content)\nprint(''Done'')\n\")",
      "Bash(\"C:/Users/andrey220197/Desktop/clade_lud/gambling-help-app/venv/Scripts/python.exe\" -c \"print(''hello'')\")",
      "Bash(node -e:*)",
      "Bash(\"C:/Users/andrey220197/Desktop/clade_lud/gambling-help-app/venv/Scripts/python.exe\" /tmp/profile_update.py)",
      "Bash(\"C:/Users/andrey220197/Desktop/clade_lud/gambling-help-app/venv/Scripts/python.exe\" -c \"print(''test'')\")",
      "Bash(python -c:*)",
      "Bash(\"C:/Users/andrey220197/Desktop/clade_lud/gambling-help-app/venv/Scripts/python.exe\" -c \"\nimport sys\nsys.path.insert(0, ''C:/Users/andrey220197/Desktop/clade_lud/gambling-help-app/backend'')\nfrom app.api.tests import *\nprint(''Import OK'')\n\")"
    ]
  }
}
